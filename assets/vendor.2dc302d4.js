var kt=Object.defineProperty,qt=Object.defineProperties;var Wt=Object.getOwnPropertyDescriptors;var rt=Object.getOwnPropertySymbols;var Xt=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable;var ot=(e,t,n)=>t in e?kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,st=(e,t)=>{for(var n in t||(t={}))Xt.call(t,n)&&ot(e,n,t[n]);if(rt)for(var n of rt(t))Vt.call(t,n)&&ot(e,n,t[n]);return e},ct=(e,t)=>qt(e,Wt(t));function j(){}function Oe(e,t){for(const n in t)e[n]=t[n];return e}function at(e){return e()}function ft(){return Object.create(null)}function ae(e){e.forEach(at)}function jt(e){return typeof e=="function"}function J(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let me;function fi(e,t){return me||(me=document.createElement("a")),me.href=t,e===me.href}function Jt(e){return Object.keys(e).length===0}function ve(e,...t){if(e==null)return j;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function W(e,t,n){e.$$.on_destroy.push(ve(t,n))}function ze(e,t,n,i){if(e){const r=lt(e,t,n,i);return e[0](r)}}function lt(e,t,n,i){return e[1]&&i?Oe(n.ctx.slice(),e[1](i(t))):n.ctx}function Ne(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const c=[],s=Math.max(t.dirty.length,r.length);for(let o=0;o<s;o+=1)c[o]=t.dirty[o]|r[o];return c}return t.dirty|r}return t.dirty}function De(e,t,n,i,r,c){if(r){const s=lt(t,n,i,c);e.p(s,r)}}function Pe(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let i=0;i<n;i++)t[i]=-1;return t}return-1}function ut(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}function ge(e,t,n){return e.set(n),t}function Ge(e,t){e.appendChild(t)}function Kt(e,t,n){e.insertBefore(t,n||null)}function Ce(e){e.parentNode.removeChild(e)}function li(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function He(e){return document.createElement(e)}function Qt(e){return document.createTextNode(e)}function Zt(){return Qt(" ")}function dt(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function _t(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ui(e){return e===""?null:+e}function $t(e){return Array.from(e.childNodes)}function di(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function _i(e,t){e.value=t==null?"":t}function hi(e,t){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t){i.selected=!0;return}}e.selectedIndex=-1}function mi(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let ye;function en(){if(ye===void 0){ye=!1;try{typeof window!="undefined"&&window.parent&&window.parent.document}catch{ye=!0}}return ye}function tn(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const i=He("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const r=en();let c;return r?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",c=dt(window,"message",s=>{s.source===i.contentWindow&&t()})):(i.src="about:blank",i.onload=()=>{c=dt(i.contentWindow,"resize",t)}),Ge(e,i),()=>{(r||c&&i.contentWindow)&&c(),Ce(i)}}let pe;function be(e){pe=e}function we(){if(!pe)throw new Error("Function called outside component initialization");return pe}function nn(e){we().$$.on_mount.push(e)}function re(e){we().$$.on_destroy.push(e)}function xe(e,t){we().$$.context.set(e,t)}function Ue(e){return we().$$.context.get(e)}const fe=[],Be=[],Ee=[],Ye=[],ht=Promise.resolve();let ke=!1;function mt(){ke||(ke=!0,ht.then(vt))}function rn(){return mt(),ht}function Ae(e){Ee.push(e)}function vi(e){Ye.push(e)}let qe=!1;const We=new Set;function vt(){if(!qe){qe=!0;do{for(let e=0;e<fe.length;e+=1){const t=fe[e];be(t),on(t.$$)}for(be(null),fe.length=0;Be.length;)Be.pop()();for(let e=0;e<Ee.length;e+=1){const t=Ee[e];We.has(t)||(We.add(t),t())}Ee.length=0}while(fe.length);for(;Ye.length;)Ye.pop()();ke=!1,qe=!1,We.clear()}}function on(e){if(e.fragment!==null){e.update(),ae(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ae)}}const Le=new Set;let ee;function sn(){ee={r:0,c:[],p:ee}}function cn(){ee.r||ae(ee.c),ee=ee.p}function te(e,t){e&&e.i&&(Le.delete(e),e.i(t))}function le(e,t,n,i){if(e&&e.o){if(Le.has(e))return;Le.add(e),ee.c.push(()=>{Le.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}}function gi(e,t,n){const i=e.$$.props[t];i!==void 0&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function yi(e){e&&e.c()}function an(e,t,n,i){const{fragment:r,on_mount:c,on_destroy:s,after_update:o}=e.$$;r&&r.m(t,n),i||Ae(()=>{const a=c.map(at).filter(jt);s?s.push(...a):ae(a),e.$$.on_mount=[]}),o.forEach(Ae)}function fn(e,t){const n=e.$$;n.fragment!==null&&(ae(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ln(e,t){e.$$.dirty[0]===-1&&(fe.push(e),mt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Q(e,t,n,i,r,c,s,o=[-1]){const a=pe;be(e);const f=e.$$={fragment:null,ctx:null,props:c,update:j,not_equal:r,bound:ft(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:ft(),dirty:o,skip_bound:!1,root:t.target||a.$$.root};s&&s(f.root);let u=!1;if(f.ctx=n?n(e,t.props||{},(m,h,..._)=>{const y=_.length?_[0]:h;return f.ctx&&r(f.ctx[m],f.ctx[m]=y)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](y),u&&ln(e,m)),h}):[],f.update(),u=!0,ae(f.before_update),f.fragment=i?i(f.ctx):!1,t.target){if(t.hydrate){const m=$t(t.target);f.fragment&&f.fragment.l(m),m.forEach(Ce)}else f.fragment&&f.fragment.c();t.intro&&te(e.$$.fragment),an(e,t.target,t.anchor,t.customElement),vt()}be(a)}class Z{$destroy(){fn(this,1),this.$destroy=j}$on(t,n){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!Jt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const oe=[];function un(e,t){return{subscribe:U(e,t).subscribe}}function U(e,t=j){let n;const i=new Set;function r(o){if(J(e,o)&&(e=o,n)){const a=!oe.length;for(const f of i)f[1](),oe.push(f,e);if(a){for(let f=0;f<oe.length;f+=2)oe[f][0](oe[f+1]);oe.length=0}}}function c(o){r(o(e))}function s(o,a=j){const f=[o,a];return i.add(f),i.size===1&&(n=t(r)||j),o(e),()=>{i.delete(f),i.size===0&&(n(),n=null)}}return{set:r,update:c,subscribe:s}}const gt={},yt={},Xe={};function ne(){return Ue(gt)}function dn(){return Ue(yt)}function ue(){return Ue(Xe)}function _n(e){xe(Xe,e)}function hn(e,t){e[t]=e[e.length-1],e.pop()}function Te(e,t){const n=e.indexOf(t);~n&&hn(e,n)}function pt(e,t){let n=0;const i=[],r=[],c=[],s={index:0,meshes:i,transparent_meshes:r,child_layers:c,needs_sort:!1,needs_transparency_sort:!0,add_mesh:(o,a)=>{a&&Te(o.transparent?i:r,o),o.transparent?(r.push(o),s.needs_transparency_sort=!0):i.push(o),re(()=>{Te(i,o),Te(r,o),t()})},add_child:(o=n++)=>{const a=pt(o,t);return c.push(a),s.needs_sort=!0,re(()=>{Te(c,a),s.needs_sort=!0,t()}),a}};return s}function Ie(e){if(typeof e=="number"){const t=(e&16711680)>>16,n=(e&65280)>>8,i=e&255;return new Float32Array([t/255,n/255,i/255])}return e}function bt(e,t=e){let n=0;for(let r=0;r<t.length;r+=1)n+=t[r]*t[r];const i=Math.sqrt(n);return e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i,e}function wt(e){const t=new Map;return(...n)=>{const i=JSON.stringify(n);return t.has(i)||t.set(i,e(...n)),t.get(i)}}var mn=1e-6,k=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function q(){var e=new k(16);return k!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function vn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gn(e,t){if(e===t){var n=t[1],i=t[2],r=t[3],c=t[6],s=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=c,e[11]=t[14],e[12]=r,e[13]=s,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function xt(e,t){var n=t[0],i=t[1],r=t[2],c=t[3],s=t[4],o=t[5],a=t[6],f=t[7],u=t[8],m=t[9],h=t[10],_=t[11],y=t[12],E=t[13],b=t[14],L=t[15],R=n*o-i*s,A=n*a-r*s,l=n*f-c*s,d=i*a-r*o,v=i*f-c*o,x=r*f-c*a,w=u*E-m*y,g=u*b-h*y,S=u*L-_*y,M=m*b-h*E,p=m*L-_*E,F=h*L-_*b,I=R*F-A*p+l*M+d*S-v*g+x*w;return I?(I=1/I,e[0]=(o*F-a*p+f*M)*I,e[1]=(r*p-i*F-c*M)*I,e[2]=(E*x-b*v+L*d)*I,e[3]=(h*v-m*x-_*d)*I,e[4]=(a*S-s*F-f*g)*I,e[5]=(n*F-r*S+c*g)*I,e[6]=(b*l-y*x-L*A)*I,e[7]=(u*x-h*l+_*A)*I,e[8]=(s*p-o*S+f*w)*I,e[9]=(i*S-n*p-c*w)*I,e[10]=(y*v-E*l+L*R)*I,e[11]=(m*l-u*v-_*R)*I,e[12]=(o*g-s*M-a*w)*I,e[13]=(n*M-i*g+r*w)*I,e[14]=(E*A-y*d-b*R)*I,e[15]=(u*d-m*A+h*R)*I,e):null}function Ve(e,t,n){var i=t[0],r=t[1],c=t[2],s=t[3],o=t[4],a=t[5],f=t[6],u=t[7],m=t[8],h=t[9],_=t[10],y=t[11],E=t[12],b=t[13],L=t[14],R=t[15],A=n[0],l=n[1],d=n[2],v=n[3];return e[0]=A*i+l*o+d*m+v*E,e[1]=A*r+l*a+d*h+v*b,e[2]=A*c+l*f+d*_+v*L,e[3]=A*s+l*u+d*y+v*R,A=n[4],l=n[5],d=n[6],v=n[7],e[4]=A*i+l*o+d*m+v*E,e[5]=A*r+l*a+d*h+v*b,e[6]=A*c+l*f+d*_+v*L,e[7]=A*s+l*u+d*y+v*R,A=n[8],l=n[9],d=n[10],v=n[11],e[8]=A*i+l*o+d*m+v*E,e[9]=A*r+l*a+d*h+v*b,e[10]=A*c+l*f+d*_+v*L,e[11]=A*s+l*u+d*y+v*R,A=n[12],l=n[13],d=n[14],v=n[15],e[12]=A*i+l*o+d*m+v*E,e[13]=A*r+l*a+d*h+v*b,e[14]=A*c+l*f+d*_+v*L,e[15]=A*s+l*u+d*y+v*R,e}function je(e,t,n){var i=n[0],r=n[1],c=n[2],s,o,a,f,u,m,h,_,y,E,b,L;return t===e?(e[12]=t[0]*i+t[4]*r+t[8]*c+t[12],e[13]=t[1]*i+t[5]*r+t[9]*c+t[13],e[14]=t[2]*i+t[6]*r+t[10]*c+t[14],e[15]=t[3]*i+t[7]*r+t[11]*c+t[15]):(s=t[0],o=t[1],a=t[2],f=t[3],u=t[4],m=t[5],h=t[6],_=t[7],y=t[8],E=t[9],b=t[10],L=t[11],e[0]=s,e[1]=o,e[2]=a,e[3]=f,e[4]=u,e[5]=m,e[6]=h,e[7]=_,e[8]=y,e[9]=E,e[10]=b,e[11]=L,e[12]=s*i+u*r+y*c+t[12],e[13]=o*i+m*r+E*c+t[13],e[14]=a*i+h*r+b*c+t[14],e[15]=f*i+_*r+L*c+t[15]),e}function yn(e,t,n){var i=n[0],r=n[1],c=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*c,e[9]=t[9]*c,e[10]=t[10]*c,e[11]=t[11]*c,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Et(e,t,n,i){var r=t[0],c=t[1],s=t[2],o=t[3],a=r+r,f=c+c,u=s+s,m=r*a,h=r*f,_=r*u,y=c*f,E=c*u,b=s*u,L=o*a,R=o*f,A=o*u,l=i[0],d=i[1],v=i[2];return e[0]=(1-(y+b))*l,e[1]=(h+A)*l,e[2]=(_-R)*l,e[3]=0,e[4]=(h-A)*d,e[5]=(1-(m+b))*d,e[6]=(E+L)*d,e[7]=0,e[8]=(_+R)*v,e[9]=(E-L)*v,e[10]=(1-(m+y))*v,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function pn(e,t,n,i,r){var c=1/Math.tan(t/2),s;return e[0]=c/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,r!=null&&r!==1/0?(s=1/(i-r),e[10]=(r+i)*s,e[14]=2*r*i*s):(e[10]=-1,e[14]=-2*i),e}var bn=pn;function At(e,t,n,i){var r=t[0],c=t[1],s=t[2],o=i[0],a=i[1],f=i[2],u=r-n[0],m=c-n[1],h=s-n[2],_=u*u+m*m+h*h;_>0&&(_=1/Math.sqrt(_),u*=_,m*=_,h*=_);var y=a*h-f*m,E=f*u-o*h,b=o*m-a*u;return _=y*y+E*E+b*b,_>0&&(_=1/Math.sqrt(_),y*=_,E*=_,b*=_),e[0]=y,e[1]=E,e[2]=b,e[3]=0,e[4]=m*b-h*E,e[5]=h*y-u*b,e[6]=u*E-m*y,e[7]=0,e[8]=u,e[9]=m,e[10]=h,e[11]=0,e[12]=r,e[13]=c,e[14]=s,e[15]=1,e}function Je(){var e=new k(3);return k!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function wn(e){var t=e[0],n=e[1],i=e[2];return Math.hypot(t,n,i)}function Lt(e,t,n){var i=new k(3);return i[0]=e,i[1]=t,i[2]=n,i}function xn(e,t){var n=t[0],i=t[1],r=t[2],c=n*n+i*i+r*r;return c>0&&(c=1/Math.sqrt(c)),e[0]=t[0]*c,e[1]=t[1]*c,e[2]=t[2]*c,e}function En(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ke(e,t,n){var i=t[0],r=t[1],c=t[2],s=n[0],o=n[1],a=n[2];return e[0]=r*a-c*o,e[1]=c*s-i*a,e[2]=i*o-r*s,e}function An(e,t,n){var i=t[0],r=t[1],c=t[2],s=n[3]*i+n[7]*r+n[11]*c+n[15];return s=s||1,e[0]=(n[0]*i+n[4]*r+n[8]*c+n[12])/s,e[1]=(n[1]*i+n[5]*r+n[9]*c+n[13])/s,e[2]=(n[2]*i+n[6]*r+n[10]*c+n[14])/s,e}var Ln=wn;(function(){var e=Je();return function(t,n,i,r,c,s){var o,a;for(n||(n=3),i||(i=0),r?a=Math.min(r*n+i,t.length):a=t.length,o=i;o<a;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],c(e,e,s),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}})();const Tn=e=>({width:e[0]&2,height:e[0]&1}),Tt=e=>({width:e[1],height:e[0]});function It(e){let t;const n=e[15].default,i=ze(n,e,e[14],Tt);return{c(){i&&i.c()},m(r,c){i&&i.m(r,c),t=!0},p(r,c){i&&i.p&&(!t||c[0]&16387)&&De(i,n,r,r[14],t?Ne(n,r[14],c,Tn):Pe(r[14]),Tt)},i(r){t||(te(i,r),t=!0)},o(r){le(i,r),t=!1},d(r){i&&i.d(r)}}}function In(e){let t,n,i,r,c,s=e[4]&&It(e);return{c(){t=He("div"),n=He("canvas"),i=Zt(),s&&s.c(),_t(n,"class","svelte-6pzapg"),_t(t,"class","container svelte-6pzapg"),Ae(()=>e[17].call(t))},m(o,a){Kt(o,t,a),Ge(t,n),e[16](n),Ge(t,i),s&&s.m(t,null),r=tn(t,e[17].bind(t)),c=!0},p(o,a){o[4]?s?(s.p(o,a),a[0]&16&&te(s,1)):(s=It(o),s.c(),te(s,1),s.m(t,null)):s&&(sn(),le(s,1,1,()=>{s=null}),cn())},i(o){c||(te(s),c=!0)},o(o){le(s),c=!1},d(o){o&&Ce(t),e[16](null),s&&s.d(),r()}}}function Sn(e){const t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.top<window.innerHeight&&t.left<window.innerWidth}function Mn(e){return un(!1,t=>{if(typeof IntersectionObserver!="undefined"){const n=new IntersectionObserver(i=>{t(Sn(e))});return n.observe(e),()=>n.unobserve(e)}if(typeof window!="undefined"){let n=function(){const{top:i,bottom:r}=e.getBoundingClientRect();t(r>0&&i<window.innerHeight)};return window.addEventListener("scroll",n),window.addEventListener("resize",n),()=>{window.removeEventListener("scroll",n),window.removeEventListener("resize",n)}}})}const St=8;function Fn(e,t,n){let i,r,c=j,s=()=>(c(),c=ve(L,T=>n(13,r=T)),L),o,a;e.$$.on_destroy.push(()=>c());let{$$slots:f={},$$scope:u}=t,{background:m=[1,1,1]}=t,{backgroundOpacity:h=1}=t,{fog:_=void 0}=t,{pixelRatio:y=void 0}=t;const E="fog"in t;let b,L=U(!1);s();let R=!1,A=!1,l,d=()=>{},v={camera_matrix:U(),view:U(),projection:U()};const x=typeof window!="undefined"?()=>{A||(A=!0,requestAnimationFrame(d))}:()=>{},w=U(1);W(e,w,T=>n(1,a=T));const g=U(1);W(e,g,T=>n(0,o=T));const S=pt(0,x),M={};let p=M;const F={ambient:[],directional:[],point:[]};function I(T){return K=>{T.push(K),x(),re(()=>{const X=T.indexOf(K);~X&&T.splice(X,1),x()})}}const P=new Map;let G=!0;const D=ct(st({defines:[`#define NUM_LIGHTS 2
#define USE_FOG ${E}
`].join(""),add_camera:T=>{if(p&&p!==M)throw new Error("A scene can only have one camera");p=T,x(),v.camera_matrix.set(p.matrix),v.projection.set(p.projection),v.view.set(p.view),re(()=>{p=M,x()})},update_camera:T=>{v.camera_matrix.set(T.matrix),v.view.set(T.view),v.projection.set(T.projection),G=!0,x()},add_directional_light:I(F.directional),add_point_light:I(F.point),add_ambient_light:I(F.ambient),get_target(T){return P.has(T)||P.set(T,U(null)),P.get(T)},invalidate:x},v),{width:w,height:g});xe(gt,D),xe(yt,S);const se=vn(q()),_e=U(se);xe(Xe,{get_matrix_world:()=>se,ctm:{subscribe:_e.subscribe}}),nn(()=>{n(12,D.canvas=b,D),n(4,l=n(12,D.gl=b.getContext("webgl"),D)),s(n(3,L=Mn(b))),["OES_element_index_uint","OES_standard_derivatives"].forEach(X=>{if(!l.getExtension(X))throw new Error(`Unsupported extension: ${X}`)}),d=X=>{if(!p)return;if(ce){const O=y||window.devicePixelRatio||1;n(2,b.width=a*O,b),n(2,b.height=o*O,b),l.viewport(0,0,a*O,o*O),ce=!1}if(A=!1,!r&&!X){n(11,R=!0);return}n(11,R=!1),l.clearColor(...i,h),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.enable(l.CULL_FACE),l.enable(l.BLEND);const $=F.ambient.reduce((O,{color:z,intensity:H})=>[Math.min(O[0]+z[0]*H,1),Math.min(O[1]+z[1]*H,1),Math.min(O[2]+z[2]*H,1)],new Float32Array([0,0,0]));let ie,et={[l.DEPTH_TEST]:null,[l.CULL_FACE]:null};const tt=(O,z)=>{et[O]!==z&&(z?l.enable(O):l.disable(O),et[O]=z)};function nt({model:O,model_inverse_transpose:z,geometry:H,material:N,depthTest:Bt,doubleSided:Yt}){if(!!N){if(tt(l.DEPTH_TEST,Bt!==!1),tt(l.CULL_FACE,Yt!==!0),l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.SRC_ALPHA,l.ONE),N.program!==ie){if(ie=N.program,l.useProgram(N.program),l.uniform3fv(N.uniform_locations.AMBIENT_LIGHT,$),E&&(l.uniform3fv(N.uniform_locations.FOG_COLOR,i),l.uniform1f(N.uniform_locations.FOG_DENSITY,_)),N.uniform_locations.DIRECTIONAL_LIGHTS)for(let C=0;C<St;C+=1){const V=F.directional[C];if(!V)break;l.uniform3fv(N.uniform_locations.DIRECTIONAL_LIGHTS[C].direction,V.direction),l.uniform3fv(N.uniform_locations.DIRECTIONAL_LIGHTS[C].color,V.color),l.uniform1f(N.uniform_locations.DIRECTIONAL_LIGHTS[C].intensity,V.intensity)}if(N.uniform_locations.POINT_LIGHTS)for(let C=0;C<St;C+=1){const V=F.point[C];if(!V)break;l.uniform3fv(N.uniform_locations.POINT_LIGHTS[C].location,V.location),l.uniform3fv(N.uniform_locations.POINT_LIGHTS[C].color,V.color),l.uniform1f(N.uniform_locations.POINT_LIGHTS[C].intensity,V.intensity)}l.uniform3fv(N.uniform_locations.CAMERA_WORLD_POSITION,p.world_position),l.uniformMatrix4fv(N.uniform_locations.VIEW,!1,p.view),l.uniformMatrix4fv(N.uniform_locations.PROJECTION,!1,p.projection)}if(l.uniformMatrix4fv(N.uniform_locations.MODEL,!1,O),l.uniformMatrix4fv(N.uniform_locations.MODEL_INVERSE_TRANSPOSE,!1,z),N.apply_uniforms(l),H.set_attributes(l),H.index)l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,H.buffers.__index),l.drawElements(l[H.primitive],H.index.length,l.UNSIGNED_INT,0);else{const C=l[H.primitive];l.drawArrays(C,0,H.count)}}}function it(O){O.needs_sort&&(O.child_layers.sort((z,H)=>z.index-H.index),O.needs_sort=!1),l.depthMask(!0),l.clearDepth(1),l.clear(l.DEPTH_BUFFER_BIT);for(let z=0;z<O.meshes.length;z+=1)nt(O.meshes[z]);l.depthMask(!1),(G||O.needs_transparency_sort)&&(he(O.transparent_meshes),O.needs_transparency_sort=!1);for(let z=0;z<O.transparent_meshes.length;z+=1)nt(O.transparent_meshes[z]);for(let z=0;z<O.child_layers.length;z+=1)it(O.child_layers[z])}it(S),G=!1};const K=setTimeout(()=>{ge(w,a=b.clientWidth,a),ge(g,o=b.clientHeight,o)});return rn().then(()=>d(!0)),()=>{l.getExtension("WEBGL_lose_context").loseContext(),clearTimeout(K)}});const he=T=>{if(T.length<2)return;const K=new Map,X=new Float32Array(16);T.forEach($=>{const ie=Ve(X,p.view,$.model)[14];K.set($,ie)}),T.sort(($,ie)=>K.get($)-K.get(ie))};let ce=!0;const Re=()=>{ce=!0,x()};function Ht(T){Be[T?"unshift":"push"](()=>{b=T,n(2,b)})}function Ut(){a=this.clientWidth,w.set(a),o=this.clientHeight,g.set(o)}return e.$$set=T=>{n(39,t=Oe(Oe({},t),ut(T))),"background"in T&&n(7,m=T.background),"backgroundOpacity"in T&&n(8,h=T.backgroundOpacity),"fog"in T&&n(9,_=T.fog),"pixelRatio"in T&&n(10,y=T.pixelRatio),"$$scope"in T&&n(14,u=T.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&128&&(i=Ie(m)),e.$$.dirty[0]&3&&Re(),e.$$.dirty[0]&4992&&D.invalidate(),e.$$.dirty[0]&14336&&r&&R&&D.invalidate()},t=ut(t),[o,a,b,L,l,w,g,m,h,_,y,R,D,r,u,f,Ht,Ut]}class pi extends Z{constructor(t){super();Q(this,t,Fn,In,J,{background:7,backgroundOpacity:8,fog:9,pixelRatio:10},null,[-1,-1])}}function Rn(){var e=new k(9);return k!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function On(){var e=new k(4);return k!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function zn(e,t){var n=t[0],i=t[1],r=t[2],c=t[3],s=n*n+i*i+r*r+c*c;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=i*s,e[2]=r*s,e[3]=c*s,e}(function(){var e=On();return function(t,n,i,r,c,s){var o,a;for(n||(n=4),i||(i=0),r?a=Math.min(r*n+i,t.length):a=t.length,o=i;o<a;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],c(e,e,s),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}})();function de(){var e=new k(4);return k!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Nn(e,t,n){n=n*.5;var i=Math.sin(n);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(n),e}function Qe(e,t,n,i){var r=t[0],c=t[1],s=t[2],o=t[3],a=n[0],f=n[1],u=n[2],m=n[3],h,_,y,E,b;return _=r*a+c*f+s*u+o*m,_<0&&(_=-_,a=-a,f=-f,u=-u,m=-m),1-_>mn?(h=Math.acos(_),y=Math.sin(h),E=Math.sin((1-i)*h)/y,b=Math.sin(i*h)/y):(E=1-i,b=i),e[0]=E*r+b*a,e[1]=E*c+b*f,e[2]=E*s+b*u,e[3]=E*o+b*m,e}function Dn(e,t){var n=t[0]+t[4]+t[8],i;if(n>0)i=Math.sqrt(n+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var r=0;t[4]>t[0]&&(r=1),t[8]>t[r*3+r]&&(r=2);var c=(r+1)%3,s=(r+2)%3;i=Math.sqrt(t[r*3+r]-t[c*3+c]-t[s*3+s]+1),e[r]=.5*i,i=.5/i,e[3]=(t[c*3+s]-t[s*3+c])*i,e[c]=(t[c*3+r]+t[r*3+c])*i,e[s]=(t[s*3+r]+t[r*3+s])*i}return e}function Mt(e,t,n,i){var r=.5*Math.PI/180;t*=r,n*=r,i*=r;var c=Math.sin(t),s=Math.cos(t),o=Math.sin(n),a=Math.cos(n),f=Math.sin(i),u=Math.cos(i);return e[0]=c*a*u-s*o*f,e[1]=s*o*u+c*a*f,e[2]=s*a*f-c*o*u,e[3]=s*a*u+c*o*f,e}var Ft=zn;(function(){var e=Je(),t=Lt(1,0,0),n=Lt(0,1,0);return function(i,r,c){var s=En(r,c);return s<-.999999?(Ke(e,t,r),Ln(e)<1e-6&&Ke(e,n,r),xn(e,e),Nn(i,e,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Ke(e,r,c),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+s,Ft(i,i))}})();(function(){var e=de(),t=de();return function(n,i,r,c,s,o){return Qe(e,i,s,o),Qe(t,r,c,o),Qe(n,e,t,2*o*(1-o)),n}})();(function(){var e=Rn();return function(t,n,i,r){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Ft(t,Dn(t,e))}})();function Pn(e){let t;const n=e[15].default,i=ze(n,e,e[14],null);return{c(){i&&i.c()},m(r,c){i&&i.m(r,c),t=!0},p(r,[c]){i&&i.p&&(!t||c&16384)&&De(i,n,r,r[14],t?Ne(n,r[14],c,null):Pe(r[14]),null)},i(r){t||(te(i,r),t=!0)},o(r){le(i,r),t=!1},d(r){i&&i.d(r)}}}function Gn(e,t,n){let i,r,c,s,o,a=j,f=()=>(a(),a=ve(r,w=>n(13,o=w)),r);e.$$.on_destroy.push(()=>a());let{$$slots:u={},$$scope:m}=t,{location:h=[0,0,0]}=t,{lookAt:_=void 0}=t,{up:y=[0,1,0]}=t,{rotation:E=[0,0,0]}=t,{scale:b=1}=t;const L=ne(),R=ue(),{ctm:A}=R;W(e,A,w=>n(12,s=w));const l=U(null);W(e,l,w=>n(11,c=w));let d=q(),v=de();const x=new Float32Array(d.buffer,12*4,3);return _n({ctm:l}),e.$$set=w=>{"location"in w&&n(3,h=w.location),"lookAt"in w&&n(4,_=w.lookAt),"up"in w&&n(5,y=w.up),"rotation"in w&&n(6,E=w.rotation),"scale"in w&&n(7,b=w.scale),"$$scope"in w&&n(14,m=w.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&n(10,i=typeof b=="number"?[b,b,b]:b),e.$$.dirty&16&&f(n(0,r=_?L.get_target(_):U(null))),e.$$.dirty&16232&&(o?(je(d,s,h),At(d,x,o,y),yn(d,d,i),ge(l,c=d,c)):(n(9,v=Mt(v||de(),...E)),n(8,d=Et(d,v,h,i)),ge(l,c=Ve(c||q(),s,d),c))),e.$$.dirty&2048&&L.invalidate()},[r,A,l,h,_,y,E,b,d,v,i,c,s,o,m,u]}class bi extends Z{constructor(t){super();Q(this,t,Gn,Pn,J,{location:3,lookAt:4,up:5,rotation:6,scale:7})}}var Cn=`precision highp float;
#define GLSLIFY 1
uniform mat4 MODEL;uniform mat4 PROJECTION;uniform mat4 VIEW;uniform mat4 MODEL_INVERSE_TRANSPOSE;uniform vec3 CAMERA_WORLD_POSITION;struct PointLight{vec3 location;vec3 color;float intensity;};uniform PointLight POINT_LIGHTS[NUM_LIGHTS];`,Hn=`#extension GL_OES_standard_derivatives : enable
precision highp float;
#define GLSLIFY 1
struct DirectionalLight{vec3 direction;vec3 color;float intensity;};struct PointLight{vec3 location;vec3 color;float intensity;};uniform vec3 AMBIENT_LIGHT;uniform DirectionalLight DIRECTIONAL_LIGHTS[NUM_LIGHTS];uniform PointLight POINT_LIGHTS[NUM_LIGHTS];`;const Ze=new Map,Un={[5126]:(e,t,n)=>e.uniform1f(t,n),[35664]:(e,t,n)=>e.uniform2fv(t,n),[35665]:(e,t,n)=>e.uniform3fv(t,n),[35666]:(e,t,n)=>e.uniform4fv(t,n),[35674]:(e,t,n)=>e.uniformMatrix2fv(t,!1,n),[35675]:(e,t,n)=>e.uniformMatrix3fv(t,!1,n),[35676]:(e,t,n)=>e.uniformMatrix4fv(t,!1,n),[35678]:(e,t,n)=>{e.activeTexture(e[`TEXTURE${n.index}`]),e.bindTexture(e.TEXTURE_2D,n.texture),e.uniform1i(t,n.index)}};function Bn(e,t,n){Ze.has(e)||Ze.set(e,new Map);const i=Ze.get(e),r=t+n;if(!i.has(r)){const c=kn(e,t,n),s=qn(e,c),o=Wn(e,c);i.set(r,{program:c,uniforms:s,attributes:o})}return i.get(r)}function Yn(e,t=4){for(e=String(e);e.length<t;)e=` ${e}`;return e}function Rt(e,t){let n="";for(;t--;)n+=e;return n}function Ot(e,t,n,i){const r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;const c=e.getShaderInfoLog(r),s=/ERROR: (\d+):(\d+): (.+)/.exec(c);if(s){const o=+s[1],a=+s[2]-1;console.log("%c"+s[3],"font-weight: bold; color: red");const f=n.split(`
`);for(let u=0;u<f.length;u+=1){if(Math.abs(a-u)>5)continue;const m=f[u].replace(/^\t+/gm,y=>Rt(" ",y.length*4)),h=/^\s+/.exec(m),_=`${Yn(u)}: ${m}`;u===a?(console.log("%c"+_,"font-weight: bold; color: red"),console.log("%c"+(h&&h[0]||"")+Rt(" ",o+6)+"^","color: red")):console.log(_)}throw new Error(`Failed to compile ${i} shader`)}throw new Error(`Failed to compile ${i} shader:
${c}`)}function kn(e,t,n){const i=e.createProgram();if(e.attachShader(i,Ot(e,e.VERTEX_SHADER,t,"vertex")),e.attachShader(i,Ot(e,e.FRAGMENT_SHADER,n,"fragment")),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(i)),new Error(`Failed to compile program:
${e.getProgramInfoLog(i)}`);return i}function qn(e,t){const n=[],i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;r+=1){let{size:c,type:s,name:o}=e.getActiveUniform(t,r);const a=e.getUniformLocation(t,o),f=Un[s];if(!f)throw new Error(`not implemented ${s} (${o})`);n.push({size:c,type:s,name:o,setter:f,loc:a})}return n}function Wn(e,t){const n=[],i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r+=1){let{size:c,type:s,name:o}=e.getActiveAttrib(t,r);o=o.replace("[0]","");const a=e.getAttribLocation(t,o);n.push({size:c,type:s,name:o,loc:a})}return n}function Xn(e,t,n){const i=t.replace(/\]$/,"").split(/\[|\]\.|\./);for(;i.length>1;){const r=i.shift(),c=i[0];e[r]||(e[r]=/^\d+$/.test(c)?[]:{}),e=e[r]}e[i[0]]=n}class Vn{constructor(t,n,i,r){this.scene=t;const c=t.gl;this.gl=c;const{program:s,uniforms:o,attributes:a}=Bn(c,t.defines+r+`

`+Cn+`

`+n,t.defines+r+`

`+Hn+`

`+i);this.program=s,this.uniforms=o,this.attributes=a,this.uniform_locations={},this.uniforms.forEach(f=>{Xn(this.uniform_locations,f.name,c.getUniformLocation(this.program,f.name))}),this.attribute_locations={},this.attributes.forEach(f=>{this.attribute_locations[f.name]=c.getAttribLocation(this.program,f.name)}),this.raw_values={},this.values={}}set_uniforms(t){let n=0;this.uniforms.forEach(({name:i,type:r,loc:c,setter:s,processor:o})=>{if(i in t){let a=t[i];if(a===this.raw_values[i])return;if(r===35678){this.values[i]={texture:a.instantiate(this.scene)._,index:n++};return}typeof a=="number"&&r!==5126&&(a=Ie(a)),this.values[i]=a}}),this.raw_values=t}apply_uniforms(t,n){this.uniforms.forEach(i=>{i.name in this.values&&i.setter(t,i.loc,this.values[i.name])})}destroy(){}}var jn=`#define GLSLIFY 1
attribute vec3 position;attribute vec3 normal;varying vec3 v_normal;
#if defined(has_colormap) || defined(has_specularitymap) || defined(has_normalmap) || defined(has_bumpmap)
#define has_textures true
#endif
#ifdef has_textures
attribute vec2 uv;varying vec2 v_uv;
#endif
#if defined(has_normalmap) || defined(has_bumpmap)
varying vec3 v_view_position;
#endif
varying vec3 v_surface_to_light[NUM_LIGHTS];
#ifdef has_specularity
varying vec3 v_surface_to_view[NUM_LIGHTS];
#endif
#ifdef USE_FOG
varying float v_fog_depth;
#endif
void main(){vec4 pos=vec4(position,1.0);vec4 model_view_pos=VIEW*MODEL*pos;v_normal=(MODEL_INVERSE_TRANSPOSE*vec4(normal,0.0)).xyz;
#ifdef has_textures
v_uv=uv;
#endif
#if defined(has_normalmap) || defined(has_bumpmap)
v_view_position=model_view_pos.xyz;
#endif
#ifdef USE_FOG
v_fog_depth=-model_view_pos.z;
#endif
for(int i=0;i<NUM_LIGHTS;i+=1){PointLight light=POINT_LIGHTS[i];vec3 surface_world_position=(MODEL*pos).xyz;v_surface_to_light[i]=light.location-surface_world_position;
#ifdef has_specularity
v_surface_to_view[i]=CAMERA_WORLD_POSITION-surface_world_position;
#endif
}gl_Position=PROJECTION*model_view_pos;}`,Jn=`#define GLSLIFY 1
#if defined(has_colormap) || defined(has_specularitymap) || defined(has_normalmap) || defined(has_bumpmap) || defined(has_emissivemap)
#define has_textures true
#endif
#ifdef has_textures
varying vec2 v_uv;
#endif
#ifdef has_specularity
uniform float specularity;
#endif
#ifdef has_colormap
uniform sampler2D colormap;
#endif
#ifdef has_emissivemap
uniform sampler2D emissivemap;
#endif
#ifdef has_specularitymap
uniform sampler2D specularitymap;
#endif
#ifdef has_bumpmap
uniform sampler2D bumpmap;vec2 dHdxy_fwd(){vec2 dSTdx=dFdx(v_uv);vec2 dSTdy=dFdy(v_uv);float Hll=texture2D(bumpmap,v_uv).x;float dBx=texture2D(bumpmap,v_uv+dSTdx).x-Hll;float dBy=texture2D(bumpmap,v_uv+dSTdy).x-Hll;
#ifdef has_bumpscale
Hll*=bumpscale;dBx*=bumpscale;dBy*=bumpscale;
#endif
return vec2(dBx,dBy);}vec3 perturbNormalArb(vec3 surf_pos,vec3 surface_normal,vec2 dHdxy){vec3 vSigmaX=vec3(dFdx(surf_pos.x),dFdx(surf_pos.y),dFdx(surf_pos.z));vec3 vSigmaY=vec3(dFdy(surf_pos.x),dFdy(surf_pos.y),dFdy(surf_pos.z));vec3 vN=surface_normal;vec3 R1=cross(vSigmaY,vN);vec3 R2=cross(vN,vSigmaX);float fDet=dot(vSigmaX,R1);fDet*=(float(gl_FrontFacing)*2.0-1.0);vec3 vGrad=sign(fDet)*(dHdxy.x*R1+dHdxy.y*R2);return normalize(abs(fDet)*surface_normal-vGrad);}
#endif
#ifdef has_bumpscale
uniform float bumpscale;
#endif
#ifdef has_normalmap
uniform sampler2D normalmap;vec3 perturbNormal2Arb(vec3 eye_pos,vec3 surface_normal){vec3 q0=vec3(dFdx(eye_pos.x),dFdx(eye_pos.y),dFdx(eye_pos.z));vec3 q1=vec3(dFdy(eye_pos.x),dFdy(eye_pos.y),dFdy(eye_pos.z));vec2 st0=dFdx(v_uv.st);vec2 st1=dFdy(v_uv.st);if(length(q0)==0.0){return surface_normal;}float scale=sign(st1.t*st0.s-st0.t*st1.s);vec3 S=normalize((q0*st1.t-q1*st0.t)*scale);vec3 T=normalize((-q0*st1.s+q1*st0.s)*scale);vec3 N=normalize(surface_normal);mat3 tsn=mat3(S,T,N);vec3 mapN=texture2D(normalmap,v_uv).xyz*2.0-1.0;mapN.xy*=(float(gl_FrontFacing)*2.0-1.0);return normalize(tsn*mapN);}
#endif
#ifdef has_color
uniform vec3 color;
#endif
#ifdef has_emissive
uniform vec3 emissive;
#endif
#ifdef has_alpha
uniform float alpha;
#endif
#ifdef USE_FOG
uniform vec3 FOG_COLOR;uniform float FOG_DENSITY;varying float v_fog_depth;
#endif
varying vec3 v_normal;
#if defined(has_normalmap) || defined(has_bumpmap)
varying vec3 v_view_position;
#endif
varying vec3 v_surface_to_light[NUM_LIGHTS];varying vec3 v_surface_to_view[NUM_LIGHTS];void main(){vec3 normal=normalize(v_normal);
#ifdef has_bumpmap
normal=perturbNormalArb(-v_view_position,normal,dHdxy_fwd());
#elif defined(has_normalmap)
normal=perturbNormal2Arb(-v_view_position,normal);
#endif
vec3 lighting=vec3(0.0);vec3 spec_amount=vec3(0.0);for(int i=0;i<NUM_LIGHTS;i+=1){DirectionalLight light=DIRECTIONAL_LIGHTS[i];float multiplier=clamp(dot(normal,-light.direction),0.0,1.0);lighting+=multiplier*light.color*light.intensity;}for(int i=0;i<NUM_LIGHTS;i+=1){PointLight light=POINT_LIGHTS[i];vec3 surface_to_light=normalize(v_surface_to_light[i]);float multiplier=clamp(dot(normal,surface_to_light),0.0,1.0);lighting+=multiplier*light.color*light.intensity;
#ifdef has_specularity
vec3 surface_to_view=normalize(v_surface_to_view[i]);vec3 half_vector=normalize(surface_to_light+surface_to_view);float spec=clamp(dot(normal,half_vector),0.0,1.0);
#ifdef has_specularitymap
spec*=texture2D(specularitymap,v_uv).r;
#endif
spec_amount+=specularity*spec*light.color*light.intensity;
#endif
}
#if defined(has_colormap)
gl_FragColor=texture2D(colormap,v_uv);
#elif defined(has_color)
gl_FragColor=vec4(color,1.0);
#endif
#ifdef has_alpha
gl_FragColor.a*=alpha;
#endif
gl_FragColor.rgb*=mix(AMBIENT_LIGHT,vec3(1.0,1.0,1.0),lighting);gl_FragColor.rgb+=spec_amount;
#if defined(has_emissivemap)
gl_FragColor.rgb+=texture2D(emissivemap,v_uv);
#elif defined(has_emissive)
gl_FragColor.rgb+=emissive;
#endif
#ifdef USE_FOG
gl_FragColor.rgb=mix(gl_FragColor.rgb,FOG_COLOR,1.0-exp(-FOG_DENSITY*FOG_DENSITY*v_fog_depth*v_fog_depth));
#endif
}`;function Kn(e,t,n){let i,r,c,s,o,a,f,u,{location:m=[0,0,0]}=t,{rotation:h=[0,0,0]}=t,{scale:_=1}=t,{geometry:y}=t,{vert:E=jn}=t,{frag:b=Jn}=t,{uniforms:L={}}=t,{depthTest:R=void 0}=t,{doubleSided:A=void 0}=t,{transparent:l=!1}=t;const d=ne(),v=dn(),{ctm:x}=ue();W(e,x,p=>n(18,u=p)),q();const w=q(),g={};let S=!0;const M=()=>{v.add_mesh(g,S),S=!1};return re(()=>{g.material&&g.material.destroy()}),e.$$set=p=>{"location"in p&&n(1,m=p.location),"rotation"in p&&n(2,h=p.rotation),"scale"in p&&n(3,_=p.scale),"geometry"in p&&n(4,y=p.geometry),"vert"in p&&n(5,E=p.vert),"frag"in p&&n(6,b=p.frag),"uniforms"in p&&n(7,L=p.uniforms),"depthTest"in p&&n(8,R=p.depthTest),"doubleSided"in p&&n(9,A=p.doubleSided),"transparent"in p&&n(10,l=p.transparent)},e.$$.update=()=>{e.$$.dirty&8&&n(16,i=typeof _=="number"?[_,_,_]:_),e.$$.dirty&131076&&n(17,r=Mt(r||de(),...h)),e.$$.dirty&229378&&n(15,c=Et(c||q(),r,m,i)),e.$$.dirty&296960&&n(11,s=Ve(s||q(),u,c)),e.$$.dirty&128&&n(14,o=Object.keys(L).filter(p=>L[p]!=null).map(p=>`#define has_${p} true
`).join("")),e.$$.dirty&16480&&n(13,a=new Vn(d,E,b,o)),e.$$.dirty&8320&&a.set_uniforms(L),e.$$.dirty&8208&&n(12,f=y.instantiate(d,a.program)),e.$$.dirty&2048&&(g.model=s),e.$$.dirty&2048&&(g.model_inverse_transpose=(xt(w,s),gn(w,w))),e.$$.dirty&8192&&(g.material=a),e.$$.dirty&4096&&(g.geometry=f),e.$$.dirty&256&&(g.depthTest=R),e.$$.dirty&512&&(g.doubleSided=A),e.$$.dirty&1024&&(g.transparent=l),e.$$.dirty&1024&&M(),e.$$.dirty&3072&&l&&(v.needs_transparency_sort=!0),e.$$.dirty&6272&&d.invalidate()},[x,m,h,_,y,E,b,L,R,A,l,s,f,a,o,c,i,r,u]}class wi extends Z{constructor(t){super();Q(this,t,Kn,null,J,{location:1,rotation:2,scale:3,geometry:4,vert:5,frag:6,uniforms:7,depthTest:8,doubleSided:9,transparent:10})}}function Qn(e,t,n){let i,r,c,s,{id:o}=t,{location:a=[0,0,0]}=t;const{get_target:f}=ne(),{ctm:u}=ue();W(e,u,y=>n(8,s=y));let m=q();const h=new Float32Array(m.buffer,12*4,3),_=new Float32Array(3);return e.$$set=y=>{"id"in y&&n(1,o=y.id),"location"in y&&n(2,a=y.location)},e.$$.update=()=>{e.$$.dirty&4&&n(7,i=a[0]),e.$$.dirty&4&&n(6,r=a[1]),e.$$.dirty&4&&n(5,c=a[2]),e.$$.dirty&224&&(n(4,_[0]=i,_),n(4,_[1]=r,_),n(4,_[2]=c,_)),e.$$.dirty&280&&n(3,m=je(m,s,_)),e.$$.dirty&10&&f(o).set(h)},[u,o,a,m,_,c,r,i,s]}class xi extends Z{constructor(t){super();Q(this,t,Qn,null,J,{id:1,location:2})}}function Zn(e,t,n){let{color:i=[1,1,1]}=t,{intensity:r=.2}=t;const c=ne(),s={};return c.add_ambient_light(s),e.$$set=o=>{"color"in o&&n(0,i=o.color),"intensity"in o&&n(1,r=o.intensity)},e.$$.update=()=>{e.$$.dirty&1&&n(2,s.color=Ie(i),s),e.$$.dirty&2&&n(2,s.intensity=r,s),e.$$.dirty&4&&c.invalidate()},[i,r,s]}class Ei extends Z{constructor(t){super();Q(this,t,Zn,null,J,{color:0,intensity:1})}}function $n(e,t,n){let i,{location:r=new Float32Array([-1,-1,-1])}=t,{color:c=new Float32Array([1,1,1])}=t,{intensity:s=1}=t;const o=ne(),{ctm:a}=ue();W(e,a,u=>n(5,i=u));let f={location:Je(),color:null,intensity:null};return o.add_point_light(f),e.$$set=u=>{"location"in u&&n(1,r=u.location),"color"in u&&n(2,c=u.color),"intensity"in u&&n(3,s=u.intensity)},e.$$.update=()=>{e.$$.dirty&50&&n(4,f.location=An(f.location,r,i),f),e.$$.dirty&4&&n(4,f.color=Ie(c),f),e.$$.dirty&8&&n(4,f.intensity=s,f),e.$$.dirty&16&&o.invalidate()},[a,r,c,s,f,i]}class Ai extends Z{constructor(t){super();Q(this,t,$n,null,J,{location:1,color:2,intensity:3})}}function Se(e,t,n){return e<t?t:e>n?n:e}function Me(e){let t=!1,n;function i(){e(n),t=!1}return function(r){t||(requestAnimationFrame(i),t=!0),n=r}}const ei=e=>({location:e&1,target:e&2}),zt=e=>({location:e[0],target:e[1]});function ti(e){let t;const n=e[7].default,i=ze(n,e,e[6],zt);return{c(){i&&i.c()},m(r,c){i&&i.m(r,c),t=!0},p(r,[c]){i&&i.p&&(!t||c&67)&&De(i,n,r,r[6],t?Ne(n,r[6],c,ei):Pe(r[6]),zt)},i(r){t||(te(i,r),t=!0)},o(r){le(i,r),t=!1},d(r){i&&i.d(r)}}}const Nt=1e-6;function Dt(e,t){return Math.sqrt(e*e+t*t)}function ni(e,t,n){let{$$slots:i={},$$scope:r}=t;const c=ne();let{location:s=new Float32Array([1,3,5])}=t,{target:o=new Float32Array([0,1,0])}=t,{minDistance:a=0}=t,{maxDistance:f=1/0}=t,{minPolarAngle:u=0}=t,{maxPolarAngle:m=Math.PI}=t;function h(d,v){const x=s[0]-o[0],w=s[1]-o[1],g=s[2]-o[2],S=Math.sqrt(x*x+w*w+g*g);let M=Math.atan2(x,g);M-=d;let p=Math.acos(Se(w/S,-1,1));p=Se(p-v,Nt,Math.PI-Nt),p=Se(p,u,m);const F=Math.sin(p)*S,I=F*Math.sin(M),P=Math.cos(p)*S,G=F*Math.cos(M);n(0,s[0]=o[0]+I,s),n(0,s[1]=o[1]+P,s),n(0,s[2]=o[2]+G,s)}function _(d,v){const x=s[0]-o[0];s[1]-o[1];const w=s[2]-o[2];{const g=bt([x,w]),S=-g[0]*v,M=-g[1]*v;n(0,s[0]+=S,s),n(0,s[2]+=M,s),n(1,o[0]+=S,o),n(1,o[2]+=M,o)}{const g=bt([-w,x]),S=g[0]*d,M=g[1]*d;n(0,s[0]+=S,s),n(0,s[2]+=M,s),n(1,o[0]+=S,o),n(1,o[2]+=M,o)}}function y(d){let v=s[0]-o[0],x=s[1]-o[1],w=s[2]-o[2];const g=Math.sqrt(v*v+x*x+w*w);d=Se(d,g/f,a?g/a:1/0),v/=d,x/=d,w/=d,n(0,s[0]=o[0]+v,s),n(0,s[1]=o[1]+x,s),n(0,s[2]=o[2]+w,s)}function E(d){let v=d.clientX,x=d.clientY;const w=Me(S=>{const M=S.clientX,p=S.clientY,F=M-v,I=p-x;S.shiftKey||S.which===2?_(F*.01,I*.01):h(F*.005,I*.005),v=M,x=p});function g(S){window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",g)}window.addEventListener("mousemove",w),window.addEventListener("mouseup",g)}const b=Me(d=>{y(Math.pow(1.004,d.wheelDeltaY))});function L(d){d.preventDefault(),b(d)}function R(d){d.preventDefault();const v=d.touches[0],x=v.identifier;let w=v.clientX,g=v.clientY;const S=Me(p=>{if(p.touches.length>1)return;const F=p.touches[0];if(F.identifier!==x)return;const I=F.clientX-w,P=F.clientY-g;h(I*.003,P*.003),w=F.clientX,g=F.clientY});function M(p){let F=p.changedTouches.length;for(;F--;)if(p.changedTouches[F].identifier===x){window.removeEventListener("touchmove",S),window.removeEventListener("touchend",M);return}}window.addEventListener("touchmove",S),window.addEventListener("touchend",M)}function A(d){d.preventDefault();const v=d.touches[0],x=d.touches[1],w=v.identifier,g=x.identifier;let S=(v.clientX+x.clientX)/2,M=(v.clientY+x.clientY)/2,p=Dt(x.clientX-v.clientX,x.clientY-v.clientY);const F=Me(P=>{if(P.touches.length!==2){alert(`${P.touches.length} touches`);return}const G=P.touches[0],D=P.touches[1];if(G.identifier!==w&&G.identifier!==g||D.identifier!==w&&D.identifier!==g)return;const se=(G.clientX+D.clientX)/2,_e=(G.clientY+D.clientY)/2,he=Dt(D.clientX-G.clientX,D.clientY-G.clientY),ce=se-S,Re=_e-M;_(ce*.01,Re*.01),y(he/p),S=se,M=_e,p=he});function I(P){let G=P.changedTouches.length;for(;G--;){const D=P.changedTouches[G];if(D.identifier===w||D.identifier===g){window.removeEventListener("touchmove",F),window.removeEventListener("touchend",I);return}}}window.addEventListener("touchmove",F),window.addEventListener("touchend",I)}function l(d){d.touches.length===1&&R(d),d.touches.length===2&&A(d)}return c.canvas.addEventListener("mousedown",E),c.canvas.addEventListener("mousewheel",L),c.canvas.addEventListener("touchstart",l),re(()=>{c.canvas.removeEventListener("mousedown",E),c.canvas.removeEventListener("mousewheel",L),c.canvas.removeEventListener("touchstart",l)}),e.$$set=d=>{"location"in d&&n(0,s=d.location),"target"in d&&n(1,o=d.target),"minDistance"in d&&n(2,a=d.minDistance),"maxDistance"in d&&n(3,f=d.maxDistance),"minPolarAngle"in d&&n(4,u=d.minPolarAngle),"maxPolarAngle"in d&&n(5,m=d.maxPolarAngle),"$$scope"in d&&n(6,r=d.$$scope)},[s,o,a,f,u,m,r,i]}class Li extends Z{constructor(t){super();Q(this,t,ni,ti,J,{location:0,target:1,minDistance:2,maxDistance:3,minPolarAngle:4,maxPolarAngle:5})}}function ii(e,t,n){let i,r,c,s=j,o=()=>(s(),s=ve(w,g=>n(13,c=g)),w),a;e.$$.on_destroy.push(()=>s());let{location:f=[0,0,0]}=t,{lookAt:u=null}=t,{up:m=[0,1,0]}=t,{fov:h=60}=t,{near:_=1}=t,{far:y=2e4}=t;const{add_camera:E,update_camera:b,width:L,height:R,get_target:A}=ne();W(e,L,g=>n(12,r=g)),W(e,R,g=>n(11,i=g));const{ctm:l}=ue();W(e,l,g=>n(14,a=g));const d=q(),v=new Float32Array(d.buffer,12*4,3);let x={matrix:d,world_position:v,view:q(),projection:q()},w=U(null);return o(),E(x),e.$$set=g=>{"location"in g&&n(4,f=g.location),"lookAt"in g&&n(5,u=g.lookAt),"up"in g&&n(6,m=g.up),"fov"in g&&n(7,h=g.fov),"near"in g&&n(8,_=g.near),"far"in g&&n(9,y=g.far)},e.$$.update=()=>{e.$$.dirty&33&&(typeof u=="string"?o(n(0,w=A(u))):w.set(u)),e.$$.dirty&25680&&n(10,x.matrix=(je(x.matrix,a,f),c&&At(x.matrix,v,c,m),x.matrix),x),e.$$.dirty&1024&&n(10,x.view=xt(x.view,x.matrix),x),e.$$.dirty&8064&&n(10,x.projection=bn(x.projection,h/180*Math.PI,r/i,_,y),x),e.$$.dirty&1024&&b(x)},[w,L,R,l,f,u,m,h,_,y,x,i,r,c,a]}class Ti extends Z{constructor(t){super();Q(this,t,ii,null,J,{location:4,lookAt:5,up:6,fov:7,near:8,far:9})}}class ri{constructor(t,n,i,r,c,s){this.scene=t;const o=t.gl;this.attributes=i,this.index=r,this.primitive=c,this.count=s,this.locations={},this.buffers={};for(const a in i){const f=i[a];this.locations[a]=o.getAttribLocation(n,a);const u=o.createBuffer();this.buffers[a]=u,o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,f.data,f.dynamic?o.DYNAMIC_DRAW:o.STATIC_DRAW)}if(r){const a=o.createBuffer();this.buffers.__index=a,o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,a),o.bufferData(o.ELEMENT_ARRAY_BUFFER,r,o.STATIC_DRAW)}}set_attributes(t){for(const n in this.attributes){const i=this.attributes[n],r=this.locations[n];if(r<0)continue;const{size:c=3,type:s=t.FLOAT,normalized:o=!1,stride:a=0,offset:f=0}=i,u=this.buffers[n];t.bindBuffer(t.ARRAY_BUFFER,u),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,c,s,o,a,f)}}update(t,n,i){const r=this.scene,{gl:c}=r,s=this.attributes[t],o=this.buffers[t];if(c.bindBuffer(c.ARRAY_BUFFER,o),c.bufferData(c.ARRAY_BUFFER,s.data=n,s.dynamic?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.count=i,i===1/0)throw new Error("GL.Geometry must be instantiated with one or more { data, size } attributes");r.invalidate()}}class $e{constructor(t={},n={}){this.attributes=t;const{index:i,primitive:r="TRIANGLES"}=n;this.index=i,this.primitive=r.toUpperCase(),this.count=Pt(t),this.instances=new Map}instantiate(t,n){return this.instances.has(n)||this.instances.set(n,new ri(t,n,this.attributes,this.index,this.primitive,this.count)),this.instances.get(n)}update(t,n){this.attributes[t].data=n,this.count=Pt(this.attributes),this.instances.forEach(i=>{i.update(t,n,this.count)})}}function Pt(e){let t=1/0;for(const n in e){const i=e[n].data.length/e[n].size;i<t&&(t=i)}return t}var Ii=wt(()=>new $e({position:{data:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),size:3},normal:{data:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]),size:3},uv:{data:new Float32Array([1,0,0,0,1,1,0,1]),size:2}},{index:new Uint32Array([0,1,2,3,2,1])}));const B=.85065080835204,Y=.5257311121191336,Gt=new Float32Array([-Y,+B,0,+Y,+B,0,-Y,-B,0,+Y,-B,0,0,-Y,+B,0,+Y,+B,0,-Y,-B,0,+Y,-B,+B,0,-Y,+B,0,+Y,-B,0,-Y,-B,0,+Y]),oi=new Uint16Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);new $e({position:{data:Gt,size:3},normal:{data:Gt,size:3}},{index:oi});const Fe=Math.PI,Ct=Fe*2;function si(e,t){const n=(e+1)*(t+1),r=2*(t-1)*e,c=new Float32Array(n*3),s=new Float32Array(n*2),o=new Uint32Array(r*3);let a=0,f=0;for(let m=0;m<=e;m+=1){const h=m/e;for(let _=0;_<=t;_+=1){const y=_/t,E=-Math.cos(h*Ct)*Math.sin(y*Fe),b=Math.cos(y*Fe),L=Math.sin(h*Ct)*Math.sin(y*Fe);c[a++]=E,c[a++]=b,c[a++]=L,s[f++]=h,s[f++]=y}}let u=0;for(let m=0;m<e;m+=1){const h=m*(t+1);o[u++]=h+0,o[u++]=h+1,o[u++]=h+t+2;for(let _=1;_<t-1;_+=1)o[u++]=h+_,o[u++]=h+_+1,o[u++]=h+_+t+1,o[u++]=h+_+t+1,o[u++]=h+_+1,o[u++]=h+_+t+2;o[u++]=h+t-1,o[u++]=h+t,o[u++]=h+t*2}return new $e({position:{data:c,size:3},normal:{data:c,size:3},uv:{data:s,size:2}},{index:o})}function ci(e,t){throw new Error("TODO implement flat geometry")}var Si=wt(({turns:e=8,bands:t=6,shading:n="smooth"}={})=>n==="smooth"?si(e,t):ci());typeof Blob!="undefined"&&URL.createObjectURL(new Blob(["self.onmessage = e => { self.onmessage = null; eval(e.data); };"],{type:"application/javascript"}))||typeof window!="undefined"&&window.SVELTE_GL_WORKER_URL;export{Ei as A,cn as B,ui as C,mi as D,Be as E,gi as F,bi as G,vi as H,Ii as I,Si as J,Ai as K,wi as M,Li as O,Ti as P,Z as S,xi as T,_t as a,fi as b,Kt as c,Ge as d,He as e,Ce as f,pi as g,yi as h,Q as i,Zt as j,Ae as k,_i as l,an as m,j as n,hi as o,dt as p,di as q,te as r,J as s,Qt as t,le as u,fn as v,li as w,ae as x,nn as y,sn as z};
